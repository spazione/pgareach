function gformAddStripeAction(e,_){_===parseInt(gfp_stripe_js_vars.form_id)&&jQuery("#gform_"+gfp_stripe_js_vars.form_id).submit(function(){var e=jQuery("#gform_target_page_number_"+gfp_stripe_js_vars.form_id).val();if("0"===e){if(jQuery("#gform_payment_method_creditcard").length>0&&!jQuery("#gform_payment_method_creditcard").is(":checked"))return!0;gfp_stripe_clear_credit_card_error();var _=jQuery("#gform_"+gfp_stripe_js_vars.form_id),r="",i="",d=matched_condition=!1;if(1<parseInt(gfp_stripe_js_vars.num_of_rules))for(var t=[],s=0;s<gfp_stripe_js_vars.num_of_rules;s++)a={operator:gfp_stripe_js_vars.rule_field_info[s].operator,fieldId:gfp_stripe_js_vars.conditional_field_id,value:gfp_stripe_js_vars.rule_field_info[s].value,street:gfp_stripe_js_vars.rule_field_info[s].street_input_id,city:gfp_stripe_js_vars.rule_field_info[s].city_input_id,state:gfp_stripe_js_vars.rule_field_info[s].state_input_id,zip:gfp_stripe_js_vars.rule_field_info[s].zip_input_id,country:gfp_stripe_js_vars.rule_field_info[s].country_input_id},"undefined"!=typeof gfp_stripe_js_vars.rule_field_info[s].no_credit_card&&(a.no_credit_card=gfp_stripe_js_vars.rule_field_info[s].no_credit_card),t.push(a);else if("1"===gfp_stripe_js_vars.rule_has_condition){var t=[],a={operator:gfp_stripe_js_vars.rule_field_info.operator,fieldId:gfp_stripe_js_vars.conditional_field_id,value:gfp_stripe_js_vars.rule_field_info.value,street:gfp_stripe_js_vars.rule_field_info.street_input_id,city:gfp_stripe_js_vars.rule_field_info.city_input_id,state:gfp_stripe_js_vars.rule_field_info.state_input_id,zip:gfp_stripe_js_vars.rule_field_info.zip_input_id,country:gfp_stripe_js_vars.rule_field_info.country_input_id};"undefined"!=typeof gfp_stripe_js_vars.rule_field_info.no_credit_card&&(a.no_credit_card=gfp_stripe_js_vars.rule_field_info.no_credit_card),t.push(a)}else{var p={street:gfp_stripe_js_vars.rule_field_info.street_input_id,city:gfp_stripe_js_vars.rule_field_info.city_input_id,state:gfp_stripe_js_vars.rule_field_info.state_input_id,zip:gfp_stripe_js_vars.rule_field_info.zip_input_id,country:gfp_stripe_js_vars.rule_field_info.country_input_id};"undefined"==typeof gfp_stripe_js_vars.rule_field_info.no_credit_card?(r=gfp_stripe_set_stripe_info(p),i=gfp_stripe_validate_card(r)):d=!0}if("undefined"!=typeof t&&0<t.length)for(var s=0;s<t.length;s++){var f=t[s];if(gf_is_match(gfp_stripe_js_vars.form_id,f)){matched_condition=!0,"undefined"==typeof f.no_credit_card?(r=gfp_stripe_set_stripe_info(f),i=gfp_stripe_validate_card(r)):d=!0;break}}else"undefined"==typeof t&&(matched_condition=!0);if(!0===matched_condition){if(d)return _.append("<input type='hidden' name='stripe_no_credit_card' value='true' />"),!0;if(r)if(i.card_number&&i.exp_date&&i.cvc&&i.cardholder_name){Stripe.card.createToken({number:r.card_number,exp_month:r.exp_month,exp_year:r.exp_year,cvc:r.cvc,name:r.cardholder_name,address_line1:"undefined"!=typeof r.address_line1?r.address_line1:"",address_city:"undefined"!=typeof r.address_city?r.address_city:"",address_zip:"undefined"!=typeof r.address_zip?r.address_zip:"",address_state:"undefined"!=typeof r.address_state?r.address_state:"",address_country:"undefined"!=typeof r.address_country?r.address_country:""},stripeResponseHandler)}else{var n="";i.card_number||(n+=gfp_stripe_js_vars.error_messages.card_number),i.exp_date||(n+=gfp_stripe_js_vars.error_messages.expiration),i.cvc||(n+=gfp_stripe_js_vars.error_messages.security_code),i.cardholder_name||(n+=gfp_stripe_js_vars.error_messages.cardholder_name),gfp_stripe_set_credit_card_error(n)}else gfp_stripe_set_credit_card_error(gfp_stripe_js_vars.error_messages.no_card_info);return!1}return!0}})}function stripeResponseHandler(e,_){var r=jQuery("#gform_"+gfp_stripe_js_vars.form_id),i=!1,d="";if(_.error)d=_.error.message;else{var t=_.card.funding,s=jQuery.inArray(t,gfp_stripe_js_vars.allowed_funding_types);-1==s?d=t.charAt(0).toUpperCase()+t.substring(1)+gfp_stripe_js_vars.error_messages.funding:i=!0}if(!0===i){var a=_.id,p=_.card.last4,f=_.card.brand;r.append("<input type='hidden' name='stripeToken' value='"+a+"' />"),r.append("<input type='hidden' name='input_"+gfp_stripe_js_vars.creditcard_field_id+".1' value='"+p+"' />"),r.append("<input type='hidden' name='input_"+gfp_stripe_js_vars.creditcard_field_id+".4' value='"+f+"' />"),r.get(0).submit()}else gfp_stripe_set_credit_card_error(d)}function gfp_stripe_set_stripe_info(e){form_id=gfp_stripe_js_vars.form_id,Stripe.setPublishableKey(gfp_stripe_js_vars.publishable_key);var _=jQuery("#gform_"+form_id+" #input_"+form_id+"_"+gfp_stripe_js_vars.creditcard_field_id+"_1").val(),r=jQuery("#gform_"+form_id+" .ginput_card_expiration_month").val(),i=jQuery("#gform_"+form_id+" .ginput_card_expiration_year").val(),d=jQuery("#gform_"+form_id+" .ginput_card_security_code").val(),t=jQuery("#gform_"+form_id+" #input_"+form_id+"_"+gfp_stripe_js_vars.creditcard_field_id+"_5").val();if("undefined"!=typeof e)var s="undefined"!=typeof e.street?jQuery("#gform_"+form_id+" #input_"+e.street).val():"",a="undefined"!=typeof e.city?jQuery("#gform_"+form_id+" #input_"+e.city).val():"",p="undefined"!=typeof e.state?jQuery("#gform_"+form_id+" #input_"+e.state).val():"",f="undefined"!=typeof e.zip?jQuery("#gform_"+form_id+" #input_"+e.zip).val():"",n="undefined"!=typeof e.country?jQuery("#gform_"+form_id+" #input_"+e.country).val():"";return{card_number:_,exp_month:r,exp_year:i,cvc:d,cardholder_name:t,address_line1:s,address_city:a,address_state:p,address_zip:f,address_country:n}}function gfp_stripe_validate_card(e){var _=Stripe.validateCardNumber(e.card_number),r=Stripe.validateExpiry(e.exp_month,e.exp_year),i=Stripe.validateCVC(e.cvc);if(e.cardholder_name.length>0)var d=!0;else var d=!1;return{card_number:_,exp_date:r,cvc:i,cardholder_name:d}}function gfp_stripe_clear_card_info(){var e=gfp_stripe_js_vars.form_id,_=jQuery("#gform_"+e),r=_.find("#input_"+e+"_"+gfp_stripe_js_vars.creditcard_field_id+"_1");r.val(""),_.find(".ginput_card_expiration_month").val(""),_.find(".ginput_card_expiration_year").val(""),_.find(".ginput_card_security_code").val(""),_.find("#input_"+e+"_"+gfp_stripe_js_vars.creditcard_field_id+"_5").val("");var i=r.parents(".gfield").find(".gform_card_icon_container");jQuery(i).find(".gform_card_icon").removeClass("gform_card_icon_selected gform_card_icon_inactive")}function gfp_stripe_set_credit_card_error(e){var _=gfp_stripe_js_vars.form_id,r=jQuery("#gform_"+_),i=r.find("li#field_"+_+"_"+gfp_stripe_js_vars.creditcard_field_id),d=i.find("div.ginput_container");gfp_stripe_clear_card_info(),i.addClass("gfield_error"),d.after('<div id="stripe_validation_error" class="gfield_description validation_message">'+e+"</div>"),jQuery("img#gform_ajax_spinner_"+_).remove(),window["gf_submitting_"+_]=!1}function gfp_stripe_clear_credit_card_error(){jQuery("#stripe_validation_error").remove(),jQuery("#gform_"+gfp_stripe_js_vars.form_id).find("li#field_"+gfp_stripe_js_vars.form_id+"_"+gfp_stripe_js_vars.creditcard_field_id).removeClass("gfield_error")}jQuery(document).ready(function(){jQuery(document).on("gform_post_render",gformAddStripeAction)});
